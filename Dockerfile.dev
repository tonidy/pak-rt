# Pak RT Container Runtime - Development Environment
# Ubuntu-based container dengan Linux tools untuk namespace dan cgroup operations

FROM ubuntu:22.04

# Prevent interactive prompts during package installation
ENV DEBIAN_FRONTEND=noninteractive

# Install required packages untuk container runtime development
RUN apt-get update && apt-get install -y \
    # Basic development tools
    bash \
    curl \
    wget \
    git \
    vim \
    nano \
    tree \
    htop \
    # Network tools untuk container networking
    iproute2 \
    iputils-ping \
    netcat \
    bridge-utils \
    iptables \
    # System tools untuk namespace dan cgroup operations
    util-linux \
    coreutils \
    procps \
    psmisc \
    # Development dan debugging tools
    strace \
    ltrace \
    gdb \
    valgrind \
    # Testing tools
    bats \
    shellcheck \
    # JSON processing untuk container metadata
    jq \
    # Additional utilities
    file \
    lsof \
    tcpdump \
    && rm -rf /var/lib/apt/lists/*

# Create directories untuk container runtime
RUN mkdir -p /tmp/containers \
    && mkdir -p /workspace/tests \
    && mkdir -p /workspace/docs

# Setup proper permissions untuk development
RUN chmod 755 /tmp/containers

# Create non-root user untuk development (optional)
RUN useradd -m -s /bin/bash -u 1000 developer \
    && usermod -aG sudo developer \
    && echo "developer ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# Set working directory
WORKDIR /workspace

# Default user (can be overridden)
USER root

# Keep container running
CMD ["/bin/bash"]

# Labels untuk identification
LABEL maintainer="Pak RT Development Team"
LABEL description="Development environment untuk Pak RT Container Runtime"
LABEL version="1.0"